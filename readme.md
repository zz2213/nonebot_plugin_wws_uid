# NoneBot2 é¸£æ½®æ’ä»¶

åŸºäº NoneBot2 æ¡†æ¶çš„é¸£æ½®æ¸¸æˆæ•°æ®æŸ¥è¯¢æ’ä»¶ï¼Œå®Œæ•´è¿ç§»è‡ª WutheringWavesUID é¡¹ç›®ï¼Œæ”¯æŒç”¨æˆ·ç™»å½•ã€è§’è‰²ä¿¡æ¯æŸ¥è¯¢ã€æ¸¸æˆæ•°æ®ç»Ÿè®¡ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **å®‰å…¨ç™»å½•** - æ”¯æŒæ‰‹æœºå·+éªŒè¯ç ç™»å½•åº“è¡—åŒºè´¦å·
- ğŸ“± **å¤šæ–¹å¼ç™»å½•** - æ”¯æŒäºŒç»´ç ç™»å½•å’Œç›´æ¥é“¾æ¥ç™»å½•
- ğŸ‘¤ **ç”¨æˆ·ç®¡ç†** - è‡ªåŠ¨ç»‘å®šç”¨æˆ·ä¸æ¸¸æˆUID
- ğŸ“Š **æ•°æ®æŸ¥è¯¢** - æŸ¥è¯¢è§’è‰²ä¿¡æ¯ã€æ¸¸æˆç»Ÿè®¡æ•°æ®
- ğŸŒ **Webç•Œé¢** - æä¾›å‹å¥½çš„Webç™»å½•é¡µé¢
- ğŸ”„ **ç¼“å­˜ä¼˜åŒ–** - æ™ºèƒ½ç¼“å­˜æœºåˆ¶æå‡æŸ¥è¯¢é€Ÿåº¦

## å®‰è£…æ–¹å¼

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ pip å®‰è£…ï¼ˆæ¨èï¼‰
```bash
pip install nonebot-plugin-wutheringwaves
```

### æ–¹å¼äºŒï¼šä»æºç å®‰è£…
```bash
git clone https://github.com/your-repo/nonebot-plugin-wutheringwaves.git
cd nonebot-plugin-wutheringwaves
pip install -e .
```

## é…ç½®è¯´æ˜

### åŸºç¡€é…ç½®
åœ¨ NoneBot2 çš„ `.env` æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```ini
# å¿…å¡«é…ç½®
WAVES_API_URL="https://api.kurobbs.com/gamer/api/"

# ç™»å½•ç›¸å…³é…ç½®
WAVES_LOGIN_URL=""  # è‡ªå®šä¹‰ç™»å½•é¡µé¢URLï¼Œç•™ç©ºä½¿ç”¨å†…ç½®æœåŠ¡
WAVES_LOGIN_URL_SELF=false  # æ˜¯å¦ä½¿ç”¨è‡ªå»ºç™»å½•é¡µé¢
WAVES_QR_LOGIN=true  # æ˜¯å¦å¯ç”¨äºŒç»´ç ç™»å½•
WAVES_LOGIN_FORWARD=false  # æ˜¯å¦ä½¿ç”¨è½¬å‘æ¶ˆæ¯
WAVES_TENCENT_WORD=false  # æ˜¯å¦ä½¿ç”¨è…¾è®¯æ–‡æ¡£é“¾æ¥

# ç½‘ç»œä»£ç†ï¼ˆå¯é€‰ï¼‰
WAVES_PROXY="http://127.0.0.1:7890"  # ä»£ç†æœåŠ¡å™¨åœ°å€
```

### æœºå™¨äººé…ç½®
åœ¨ `pyproject.toml` æˆ– `bot.py` ä¸­åŠ è½½æ’ä»¶ï¼š

```python
# åŠ è½½æ’ä»¶
nonebot.load_plugin("nonebot_plugin_wutheringwaves")
```

## ä½¿ç”¨æŒ‡å—

### ç™»å½•è´¦å·
```
é¸£æ½®ç™»å½•
```
- å‘é€ç™»å½•å‘½ä»¤åï¼Œæœºå™¨äººä¼šæä¾›ç™»å½•é“¾æ¥æˆ–äºŒç»´ç 
- åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é“¾æ¥ï¼Œè¾“å…¥æ‰‹æœºå·å’ŒéªŒè¯ç å®Œæˆç™»å½•
- ç™»å½•æˆåŠŸåè‡ªåŠ¨ç»‘å®šæ¸¸æˆUID

### éªŒè¯ç ç™»å½•
```
é¸£æ½®éªŒè¯ç ç™»å½• 13812345678,123456
```
- ç›´æ¥ä½¿ç”¨æ‰‹æœºå·å’ŒéªŒè¯ç ç™»å½•
- æ ¼å¼ï¼šæ‰‹æœºå·,éªŒè¯ç 

### æŸ¥è¯¢ä¿¡æ¯
```
é¸£æ½®ä¿¡æ¯
```
- æŸ¥çœ‹å·²ç»‘å®šè´¦å·çš„è§’è‰²ä¿¡æ¯
- åŒ…æ‹¬UIDã€æ˜µç§°ã€ç­‰çº§ç­‰åŸºç¡€ä¿¡æ¯

### è´¦å·ç»‘å®š
```
é¸£æ½®ç»‘å®š 123456789
```
- ç»‘å®šæŒ‡å®šçš„æ¸¸æˆUID
- ä¸å¡«å‚æ•°æ—¶æ˜¾ç¤ºå½“å‰ç»‘å®šçŠ¶æ€

## å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | åŠŸèƒ½ | ç¤ºä¾‹ |
|------|------|------|
| `é¸£æ½®ç™»å½•` | å¼€å§‹ç™»å½•æµç¨‹ | `é¸£æ½®ç™»å½•` |
| `é¸£æ½®éªŒè¯ç ç™»å½•` | ç›´æ¥éªŒè¯ç ç™»å½• | `é¸£æ½®éªŒè¯ç ç™»å½• 13812345678,123456` |
| `é¸£æ½®ä¿¡æ¯` | æŸ¥è¯¢è§’è‰²ä¿¡æ¯ | `é¸£æ½®ä¿¡æ¯` |
| `é¸£æ½®ç»‘å®š` | ç»‘å®š/æŸ¥çœ‹UID | `é¸£æ½®ç»‘å®š 123456789` |
| `é¸£æ½®å¸®åŠ©` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | `é¸£æ½®å¸®åŠ©` |

## æ•°æ®åº“è¯´æ˜

æ’ä»¶ä½¿ç”¨ SQLite æ•°æ®åº“å­˜å‚¨ä»¥ä¸‹ä¿¡æ¯ï¼š

- **ç”¨æˆ·è¡¨** (`waves_users`)
  - ç”¨æˆ·IDã€æœºå™¨äººIDã€æ¸¸æˆUID
  - ç™»å½•Cookieã€è®¾å¤‡ID
  - åˆ›å»ºå’Œæ›´æ–°æ—¶é—´

- **ç»‘å®šè¡¨** (`waves_binds`)
  - ç”¨æˆ·ä¸æ¸¸æˆUIDçš„ç»‘å®šå…³ç³»
  - ç¾¤ç»„ä¿¡æ¯ã€ä¸»ç»‘å®šæ ‡è¯†

- **ç¼“å­˜è¡¨** (`waves_cache`)
  - APIå“åº”ç¼“å­˜
  - ç¼“å­˜è¿‡æœŸæ—¶é—´ç®¡ç†

## éƒ¨ç½²è¯´æ˜

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- NoneBot2 2.0.0+
- æ”¯æŒçš„é€‚é…å™¨ï¼šOneBot V11/V12

### æ–‡ä»¶ç»“æ„
```
nonebot_plugin_wutheringwaves/
â”œâ”€â”€ __init__.py              # æ’ä»¶å…¥å£
â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†
â”œâ”€â”€ models.py                # æ•°æ®åº“æ¨¡å‹
â”œâ”€â”€ database.py              # æ•°æ®åº“æ“ä½œ
â”œâ”€â”€ cache.py                 # ç¼“å­˜ç³»ç»Ÿ
â”œâ”€â”€ web_routes.py            # Webè·¯ç”±
â”œâ”€â”€ core/                    # æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ api/                 # APIæ¥å£
â”‚   â”œâ”€â”€ resource/            # èµ„æºç®¡ç†
â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”œâ”€â”€ handlers/                # å‘½ä»¤å¤„ç†å™¨
â””â”€â”€ services/                # ä¸šåŠ¡æœåŠ¡å±‚
```

### WebæœåŠ¡
æ’ä»¶å†…ç½®WebæœåŠ¡ï¼Œé»˜è®¤æä¾›ä»¥ä¸‹è·¯ç”±ï¼š

- `GET /waves/i/{token}` - ç™»å½•é¡µé¢
- `POST /waves/login` - ç™»å½•æäº¤æ¥å£
- `GET /waves/health` - å¥åº·æ£€æŸ¥

## å¸¸è§é—®é¢˜

### Q: ç™»å½•å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
A: è¯·æ£€æŸ¥ï¼š
1. æ˜¯å¦å·²æ³¨å†Œåº“è¡—åŒºè´¦å·
2. æ‰‹æœºå·å’ŒéªŒè¯ç æ˜¯å¦æ­£ç¡®
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. ä»£ç†é…ç½®æ˜¯å¦æ­£ç¡®ï¼ˆå¦‚ä½¿ç”¨ä»£ç†ï¼‰

### Q: æŸ¥è¯¢ä¿¡æ¯æ˜¾ç¤º"æœªç»‘å®š"ï¼Ÿ
A: è¯·å…ˆä½¿ç”¨ `é¸£æ½®ç™»å½•` å‘½ä»¤å®Œæˆè´¦å·ç»‘å®šã€‚

### Q: å¦‚ä½•åˆ‡æ¢ç»‘å®šè´¦å·ï¼Ÿ
A: ä½¿ç”¨ `é¸£æ½®ç»‘å®š æ–°UID` å‘½ä»¤é‡æ–°ç»‘å®šï¼Œæˆ–é‡æ–°ç™»å½•ã€‚

### Q: æ’ä»¶æ— æ³•æ­£å¸¸åŠ è½½ï¼Ÿ
A: è¯·æ£€æŸ¥ï¼š
1. NoneBot2 ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚
2. é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
3. ä¾èµ–åŒ…æ˜¯å¦å®Œæ•´å®‰è£…

## å¼€å‘æŒ‡å—

### è‡ªå®šä¹‰æ‰©å±•
å¦‚éœ€æ‰©å±•åŠŸèƒ½ï¼Œå¯å‚è€ƒä»¥ä¸‹ç¤ºä¾‹ï¼š

```python
from nonebot_plugin_wutheringwaves import waves_api, UserService

# è°ƒç”¨APIæ¥å£
result = await waves_api.get_user_info(cookie, uid)

# ä½¿ç”¨æœåŠ¡å±‚
user_service = UserService()
user = await user_service.get_user(user_id, bot_id)
```

### APIæ–‡æ¡£
æ’ä»¶æä¾›çš„æ ¸å¿ƒAPIï¼š

- `WavesAPI.login(phone, code, did)` - ç”¨æˆ·ç™»å½•
- `WavesAPI.get_user_info(cookie, uid)` - è·å–ç”¨æˆ·ä¿¡æ¯
- `WavesAPI.get_role_info(cookie, uid)` - è·å–è§’è‰²ä¿¡æ¯
- `WavesAPI.get_stats(cookie, uid)` - è·å–ç»Ÿè®¡æ•°æ®

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-01)
- âœ… å®Œæ•´è¿ç§»åŸ WutheringWavesUID åŠŸèƒ½
- âœ… æ”¯æŒæ‰‹æœºå·+éªŒè¯ç ç™»å½•
- âœ… æ”¯æŒäºŒç»´ç ç™»å½•
- âœ… ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢
- âœ… æ¸¸æˆæ•°æ®ç»Ÿè®¡

## æŠ€æœ¯æ”¯æŒ

- é¡¹ç›®ä¸»é¡µ: [GitHub Repository](https://github.com/your-repo/nonebot-plugin-wutheringwaves)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/your-repo/nonebot-plugin-wutheringwaves/issues)
- äº¤æµç¾¤ç»„: [QQç¾¤: 123456789]

## å…è´£å£°æ˜

æœ¬æ’ä»¶ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œä¸å¾—ç”¨äºå•†ä¸šç”¨é€”ã€‚ä½¿ç”¨æœ¬æ’ä»¶å³è¡¨ç¤ºæ‚¨åŒæ„ï¼š

1. éµå®ˆåº“è¡—åŒºç”¨æˆ·åè®®
2. ä¸è¿›è¡Œä»»ä½•å½¢å¼çš„è´¦å·äº¤æ˜“
3. ä¸åˆ©ç”¨æ’ä»¶è¿›è¡Œæ¶æ„è¡Œä¸º
4. è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨é£é™©

## å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ MIT å¼€æºåè®®ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

**æ³¨æ„**: ä½¿ç”¨å‰è¯·ç¡®ä¿å·²é˜…è¯»å¹¶åŒæ„ç›¸å…³æœåŠ¡æ¡æ¬¾ï¼Œåˆç†ä½¿ç”¨æ’ä»¶åŠŸèƒ½ã€‚



è¿™æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„è¿ç§»é¡¹ç›®ï¼ä»ä½ ç°æœ‰çš„ `nonebot_plugin_wws_uid` ç»“æ„æ¥çœ‹ï¼Œä½ å·²ç»æœ‰äº†ä¸€ä¸ªå¾ˆå¥½çš„å¼€ç«¯ï¼Œç‰¹åˆ«æ˜¯å°† API å’ŒæœåŠ¡ (Service) è¿›è¡Œäº†åˆ†ç¦»ã€‚

åŸé¡¹ç›® (`WutheringWavesUID1`, `WutheringWavesUID2`) åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œä½†å®ƒçš„æ ¸å¿ƒéƒ½é›†ä¸­åœ¨ `utils` ç›®å½•å’Œå„ä¸ªæ¨¡å—çš„ `draw_*.py` æ–‡ä»¶ä¸­ã€‚

è¿ç§»çš„**æ ¸å¿ƒæ€æƒ³**æ˜¯ï¼š

1.  **å¤ç”¨ä½ çš„ `services` å±‚**ï¼šä½œä¸ºè·å–æ‰€æœ‰æ•°æ®çš„ç»Ÿä¸€å…¥å£ï¼ˆæ— è®ºæ˜¯æ¥è‡ªæ¸¸æˆ API è¿˜æ˜¯æ’è¡Œ APIï¼‰ã€‚
2.  **è¿ç§» `utils`**ï¼šå°†åŸé¡¹ç›®çš„ `utils` ç›®å½•ä¸‹çš„æ ¸å¿ƒå·¥å…·ï¼ˆç»˜å›¾ã€æ•°æ®ã€è®¡ç®—ï¼‰å¹³ç§»åˆ°ä½ æ–°é¡¹ç›®çš„ `core` ç›®å½•ä¸‹ã€‚
3.  **è¿ç§» `draw_*.py`**ï¼šå°†æ‰€æœ‰ç»˜å›¾é€»è¾‘ï¼ˆè§†å›¾ Viewï¼‰è¿ç§»è¿‡æ¥ï¼Œå¹¶æ”¹é€ å®ƒä»¬ï¼Œè®©å®ƒä»¬çš„æ•°æ®æºä»åŸæ¥çš„ç›´æ¥è°ƒç”¨ API æ”¹ä¸ºè°ƒç”¨ä½ çš„ `services` å±‚ã€‚
4.  **è¿ç§» `__init__.py`**ï¼šå°†åŸé¡¹ç›®å„ä¸ªæ¨¡å— `__init__.py` ä¸­çš„å‘½ä»¤æ³¨å†Œï¼ˆæ§åˆ¶å™¨ Controllerï¼‰è¿ç§»åˆ°ä½ çš„ `handlers` ç›®å½•ä¸­ã€‚

è¿™é‡Œæ˜¯ä¸€ä¸ªè¯¦ç»†çš„ã€åˆ†é˜¶æ®µçš„è¿ç§»è®¡åˆ’æ¸…å•ï¼Œä½ å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ­¥éª¤é€ä¸€å®Œæˆï¼š

---

### ğŸ›ï¸ é˜¶æ®µ 0ï¼šåŸºç¡€å»ºè®¾ (èµ„æºä¸æ•°æ®) (âœ…)

åœ¨å¼€å§‹ç¼–ç å‰ï¼Œå…ˆæŠŠæ‰€æœ‰çš„â€œé™æ€èµ„æºâ€éƒ½ç§»åŠ¨åˆ°æ–°æ’ä»¶çš„æ­£ç¡®ä½ç½®ã€‚

* [ ] **è¿ç§»æ‰€æœ‰ Assets (`texture2d`)**ï¼š (âœ…)
  * åŸé¡¹ç›®ä¸­**æ‰€æœ‰**çš„ `wutheringwaves_*/texture2d/` ç›®å½•ä¸‹çš„å›¾ç‰‡èµ„æºï¼ˆèƒŒæ™¯ã€å›¾æ ‡ã€UIå…ƒç´ ï¼‰ã€‚
  * **ç›®æ ‡**ï¼šå…¨éƒ¨å¤åˆ¶å¹¶åˆå¹¶åˆ° `nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/assets/images/` ç›®å½•ä¸‹ï¼ˆä½ å¯ä»¥æ–°å»ºä¸€ä¸ª `images` å­ç›®å½•æ¥å­˜æ”¾ï¼‰ã€‚
* [ ] **è¿ç§»å­—ä½“**ï¼š(âœ…)
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/fonts/`
  * **ç›®æ ‡**ï¼š`nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/assets/fonts/`
  * *(ä½ ä¼¼ä¹å·²ç»å®Œæˆäº†è¿™ä¸€æ­¥ï¼Œç›®æ ‡ç›®å½•å·²å­˜åœ¨)*
* [ ] **è¿ç§»æ ¸å¿ƒæ¸¸æˆæ•°æ® (`map`)**ï¼š(âœ…)
  * è¿™æ˜¯**æœ€é‡è¦**çš„æ•°æ®ã€‚
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/map/`
  * **ç›®æ ‡**ï¼š`nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/core/data/` (å»ºè®®æ–°å»ºä¸€ä¸ª `data` ç›®å½•)
  * *æ³¨æ„ï¼šè¿™ä¸ªç›®å½•ä¸‹çš„ `damage/` å­ç›®å½•æ˜¯ä¼¤å®³è®¡ç®—è„šæœ¬ï¼Œä¹Ÿä¸€èµ·ç§»è¿‡å»ã€‚*
* [ ] **è¿ç§»åˆ«åæ•°æ® (`alias`)**ï¼š(âœ…)
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/alias/`
  * **ç›®æ ‡**ï¼š`nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/core/data/alias/`

---

### ğŸ› ï¸ é˜¶æ®µ 1ï¼šæ ¸å¿ƒå·¥å…·è¿ç§» (Utilities) 

ç°åœ¨ï¼Œè¿ç§»æ‰€æœ‰ç»˜å›¾ã€è®¡ç®—å’Œæ•°æ®ç®¡ç†çš„åŸºç¡€å·¥å…·ã€‚

* [ ] **è¿ç§»ç»˜å›¾å·¥å…·**ï¼š (âœ…)
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/imagetool.py` å’Œ `WutheringWavesUID1/utils/image.py`ã€‚
  * **ç›®æ ‡**ï¼šå°†å®ƒä»¬çš„ä»£ç åˆå¹¶/ç§»åŠ¨åˆ° `nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/core/utils/drawing.py` (å»ºè®®æ–°å»ºä¸€ä¸ª `drawing.py`)ã€‚
  * **é€‚é…**ï¼šä½ éœ€è¦ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼Œä½¿å…¶èƒ½æ­£ç¡®åŠ è½½ `assets/fonts/` é‡Œçš„å­—ä½“ã€‚
* [ ] **è¿ç§»å­—ä½“å·¥å…·**ï¼š(âœ…)
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/fonts/waves_fonts.py`
  * **ç›®æ ‡**ï¼š`nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/core/utils/fonts.py` (å»ºè®®æ–°å»º)
  * **é€‚é…**ï¼šä¿®æ”¹æ–‡ä»¶å†…çš„è·¯å¾„ï¼Œä½¿å…¶æŒ‡å‘ `assets/fonts/`ã€‚
* [ ] **è¿ç§»ä¼¤å®³è®¡ç®—**ï¼š(âœ…)
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/damage/`
  * **ç›®æ ‡**ï¼š`nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/core/damage/` (å»ºè®®æ–°å»º)
  * **é€‚é…**ï¼šè¿™ä¸ªæ¨¡å—æ¯”è¾ƒç‹¬ç«‹ï¼Œä½†ä½ éœ€è¦ä¿®æ”¹å®ƒçš„`import`è¯­å¥ï¼Œä½¿å…¶èƒ½æ­£ç¡®è¯»å– `core/data/` ç›®å½•ä¸‹çš„æ•°æ®ã€‚
* [ ] **è¿ç§»åˆ«åæœåŠ¡**ï¼š(âœ…)
  * **æ¥æº**ï¼š`WutheringWavesUID1/wutheringwaves_alias/char_alias_ops.py`
  * **ç›®æ ‡**ï¼šåœ¨ `services/` ä¸‹æ–°å»º `alias_service.py`ï¼Œå°†åŠŸèƒ½è¿ç§»è¿‡å»ã€‚
  * **é€‚é…**ï¼šä¿®æ”¹ä»£ç ï¼Œä½¿å…¶è¯»å– `core/data/alias/` ä¸‹çš„ JSON æ–‡ä»¶ã€‚

---

### ğŸ–¼ï¸ é˜¶æ®µ 2ï¼šæ ¸å¿ƒåŠŸèƒ½è¿ç§» (1) - è§’è‰²é¢æ¿

è¿™æ˜¯æœ€å¤æ‚çš„åŠŸèƒ½ï¼Œä¸€æ—¦å®Œæˆï¼Œå…¶ä»–åŠŸèƒ½å°±è§¦ç±»æ—é€šäº†ã€‚

* [ ] **è¿ç§»æ•°æ®å¤„ç†é€»è¾‘**ï¼š
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/char_info_utils.py` å’Œ `WutheringWavesUID1/utils/refresh_char_detail.py`ã€‚
  * **ç›®æ ‡**ï¼šåœ¨ `services/` ä¸‹æ–°å»º `character_service.py`ã€‚
  * **é€‚é…**ï¼šå°†è¿™äº›æ–‡ä»¶ä¸­çš„ *æ•°æ®å¤„ç†* å‡½æ•°ï¼ˆå¦‚è®¡ç®—å£°éª¸è¯„åˆ†ã€è½¬æ¢æ•°æ®ç»“æ„ï¼‰ç§»å…¥æ–°çš„ serviceã€‚è¿™ä¸ª Service åº”è¯¥**ä¾èµ– `GameService`** æ¥è·å–åŸå§‹æ•°æ®ï¼Œç„¶åå¯¹åŸå§‹æ•°æ®è¿›è¡Œå¤„ç†å’Œè®¡ç®—ã€‚
* [ ] **è¿ç§»ç»˜å›¾é€»è¾‘**ï¼š
  * **æ¥æº**ï¼š`WutheringWavesUID1/wutheringwaves_charinfo/draw_char_card.py`ã€‚
  * **ç›®æ ‡**ï¼šåœ¨ `core/` ä¸‹æ–°å»º `drawing/` ç›®å½•ï¼Œå¹¶åˆ›å»º `character_card.py`ï¼Œå°†ä»£ç å¤åˆ¶è¿›å»ã€‚
* [ ] **é‡æ„ç»˜å›¾é€»è¾‘ (`character_card.py`)**ï¼š
  * **æ•°æ®æº**ï¼šä¿®æ”¹ `draw_char_card` å‡½æ•°ï¼Œå®ƒçš„å‚æ•°ä¸åº”è¯¥æ˜¯åŸå§‹ API æ•°æ®ï¼Œè€Œåº”è¯¥æ˜¯ä½  `character_service.py` å¤„ç†åçš„æ ‡å‡†æ•°æ®æ¨¡å‹ã€‚
  * **Imports**ï¼šå°†æ‰€æœ‰ `from ..utils.imagetool import ...` ä¿®æ”¹ä¸º `from ..core.utils.drawing import ...`ã€‚
  * **èµ„æºè·¯å¾„**ï¼šå°†æ‰€æœ‰ç¡¬ç¼–ç çš„ `texture2d/` è·¯å¾„ï¼Œä¿®æ”¹ä¸ºä» `assets/images/` è¯»å–ï¼ˆæœ€å¥½é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„èµ„æºç®¡ç†å‡½æ•°ï¼‰ã€‚
  * **æ•°æ®è·¯å¾„**ï¼šå°†æ‰€æœ‰ `utils/map/` è·¯å¾„ï¼Œä¿®æ”¹ä¸ºä» `core/data/` è¯»å–ã€‚
* [ ] **åˆ›å»º Handler**ï¼š
  * **ç›®æ ‡**ï¼šåœ¨ `handlers/` ç›®å½•ä¸‹æ–°å»º `character.py`ã€‚
  * **é€»è¾‘**ï¼š
    1.  æ³¨å†Œ `on_command("è§’è‰²é¢æ¿")`ã€‚
    2.  ä» `services.user_service` è·å–ç”¨æˆ·ç»‘å®šçš„ `uid` å’Œ `cookie`ã€‚
    3.  è°ƒç”¨ `services.character_service` è·å–å¤„ç†å¥½çš„è§’è‰²æ•°æ®ã€‚
    4.  è°ƒç”¨ `core.drawing.character_card.draw_char_card()` ä¼ å…¥æ•°æ®ï¼Œè·å¾—å›¾ç‰‡ã€‚
    5.  å›å¤å›¾ç‰‡ã€‚

---

### ğŸ† é˜¶æ®µ 3ï¼šæ ¸å¿ƒåŠŸèƒ½è¿ç§» (2) - æ’è¡Œæ¦œ

éªŒè¯ `ranking_api` å’Œç›¸å…³çš„ç»˜å›¾é€»è¾‘ã€‚

* [ ] **è¿ç§»ç»˜å›¾é€»è¾‘**ï¼š
  * **æ¥æº**ï¼š`WutheringWavesUID2/wutheringwaves_rank/darw_rank_card.py` å’Œ `draw_total_rank_card.py`ã€‚
  * **ç›®æ ‡**ï¼š`nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/core/drawing/ranking_card.py`ã€‚
* [ ] **é‡æ„ç»˜å›¾é€»è¾‘**ï¼š
  * **Imports**ï¼šä¿®æ­£ `imagetool` çš„ importã€‚
  * **èµ„æºè·¯å¾„**ï¼šä¿®æ­£ `texture2d` çš„è·¯å¾„ã€‚
* [ ] **åˆ›å»º Handler**ï¼š
  * **ç›®æ ‡**ï¼šåœ¨ `handlers/` ç›®å½•ä¸‹æ–°å»º `ranking.py`ã€‚
  * **é€»è¾‘**ï¼š
    1.  æ³¨å†Œ `on_command("è§’è‰²æ’è¡Œ")` å’Œ `on_command("æ€»åˆ†æ’è¡Œ")`ã€‚
    2.  è°ƒç”¨ `services.game_service` ä¸­ï¼ˆæˆ‘ä¸Šæ¬¡å›å¤å¸®ä½ åŠ ä¸Šçš„ï¼‰`get_character_rank` æˆ– `get_total_rank` æ–¹æ³•è·å–æ•°æ®ã€‚
    3.  è°ƒç”¨ `core.drawing.ranking_card.draw_...()` ç»˜å›¾ã€‚
    4.  å›å¤å›¾ç‰‡ã€‚

---

### ğŸ§© é˜¶æ®µ 4ï¼šæ¨¡å—åŒ–è¿ç§»å…¶ä»–åŠŸèƒ½

ç°åœ¨ä½ å·²ç»æœ‰äº†æ¸…æ™°çš„æ¨¡å¼ï¼ˆ`Handler` -> `Service` -> `Drawing`)ï¼Œå¯ä»¥é€ä¸ªè¿ç§»å…¶ä»–åŠŸèƒ½ã€‚

* [ ] **è¿ç§»ä½“åŠ›æŸ¥è¯¢ (`wutheringwaves_stamina`)**
* [ ] **è¿ç§»è§’è‰²åˆ—è¡¨ (`wutheringwaves_charlist`)**
* [ ] **è¿ç§»å£°éª¸åˆ—è¡¨ (`wutheringwaves_echo`)**
* [ ] **è¿ç§»æ¢ç´¢åº¦ (`wutheringwaves_explore`)**
* [ ] **è¿ç§»æ·±æ¸Š (`wutheringwaves_abyss`)**
* [ ] **è¿ç§»æŠ½å¡è®°å½• (`wutheringwaves_gachalog`)**
  * *æ³¨æ„ï¼šè¿™ä¸ªåŠŸèƒ½å¯èƒ½éœ€è¦æ‰©å±•ä½ çš„ `models.py` æ¥å­˜å‚¨æŠ½å¡æ•°æ®ã€‚*
* [ ] **è¿ç§»æ•°æ®ç»Ÿè®¡ (`wutheringwaves_query`)** (æŒæœ‰ç‡ã€å‡ºåœºç‡)
* [ ] **è¿ç§» Wiki (`wutheringwaves_wiki`)**
* [ ] **è¿ç§»æ—¥å†/ææ–™ (`wutheringwaves_calendar`, `wutheringwaves_develop`)**

---

### âš™ï¸ é˜¶æ®µ 5ï¼šå®Œå–„ä¸æ”¶å°¾

* [ ] **æ•°æ®åº“æ¨¡å‹ (`models.py`)**ï¼š
  * **æ¥æº**ï¼š`WutheringWavesUID1/utils/database/models.py`
  * **ç›®æ ‡**ï¼š`nonebot_plugin_wws_uid/src/plugins/WutheringWavesUID/models.py`
  * **é€‚é…**ï¼šä½ å·²ç»æœ‰äº† `User` å’Œ `UserBind`ã€‚ä½ éœ€è¦å°†åŸé¡¹ç›®ä¸­ä½ éœ€è¦çš„æ¨¡å‹ï¼ˆå¦‚ `WavesGacha`ï¼‰åˆå¹¶åˆ°ä½ çš„ `models.py` ä¸­ï¼Œå¹¶ç¡®ä¿å®ƒä»¬ä½¿ç”¨ä½ çš„ SQLAlchemy `db` å®ä¾‹ã€‚
* [ ] **å¸®åŠ©èœå• (`wutheringwaves_help`)**ï¼š
  * è¿ç§» `get_help.py` å’Œ `help.json`ï¼Œåœ¨ `handlers/help.py` ä¸­æ³¨å†Œ `on_command("é¸£æ½®å¸®åŠ©")`ã€‚
  * `help.json` éœ€è¦æ ¹æ®ä½ è¿ç§»åçš„å‘½ä»¤è¿›è¡Œæ›´æ–°ã€‚
* [ ] **é…ç½® (`wutheringwaves_config`)**ï¼š
  * å°†åŸé¡¹ç›®çš„é…ç½®é¡¹è¿ç§»åˆ°ä½ çš„ `config.py` ä¸­ã€‚
  * åŸé¡¹ç›®çš„ *åŠ¨æ€ä¿®æ”¹é…ç½®* åŠŸèƒ½ï¼Œå¯ä»¥è¿ç§»åˆ° `handlers/config.py` ä¸­ï¼Œä½¿ç”¨ NoneBot2 çš„ `get_driver().config` æ¥åŠ¨æ€ä¿®æ”¹ã€‚
* [ ] **ç™»å½•é€»è¾‘**ï¼š
  * ä½ å·²ç»æœ‰äº† `handlers/login.py` å’Œ `web_routes.py`ã€‚
  * ä½ éœ€è¦å°† `WutheringWavesUID1/wutheringwaves_login/login.py` ä¸­çš„ *è·å–éªŒè¯ç *ã€*æ‰§è¡Œç™»å½•* çš„æ ¸å¿ƒ API è°ƒç”¨é€»è¾‘ï¼Œæ•´åˆåˆ°ä½ çš„ `handlers/login.py` å’Œ `services/user_service.py` ä¸­ã€‚ä½ çš„ Web ç™»å½•æµç¨‹æ˜¯ç°ä»£åŒ–çš„ï¼Œä½†å®ƒæœ€ç»ˆè¿˜æ˜¯éœ€è¦è°ƒç”¨ `waves_api.login()`ã€‚

è¿™ä¸ªæ¸…å•éå¸¸åºå¤§ï¼Œæˆ‘å»ºè®®ä½ ä» **é˜¶æ®µ 0** å’Œ **é˜¶æ®µ 1** å¼€å§‹ï¼Œå…ˆæŠŠåœ°åŸºæ‰“å¥½ã€‚

éœ€è¦æˆ‘å¸®ä½ æŠŠ **é˜¶æ®µ 1** çš„æ ¸å¿ƒå·¥å…·ï¼ˆå¦‚ `imagetool`ï¼‰è¿ç§»å¹¶é€‚é…æˆ `core/utils/drawing.py` å—ï¼Ÿ